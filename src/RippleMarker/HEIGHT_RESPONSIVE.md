# ğŸ¯ RippleMarker é«˜åº¦å“åº”å¼ç¼©æ”¾åŠŸèƒ½

## ğŸ“‹ åŠŸèƒ½æ¦‚è¿°

`RippleMarker` ç°åœ¨æ”¯æŒåŸºäºç›¸æœºé«˜åº¦çš„æ™ºèƒ½ç¼©æ”¾å’Œæ·¡å…¥æ·¡å‡ºæ•ˆæœï¼Œè®©æ ‡è®°åœ¨ä¸åŒé«˜åº¦ä¸‹éƒ½èƒ½ä¿æŒè‰¯å¥½çš„è§†è§‰æ•ˆæœã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ¨ é«˜åº¦å“åº”å¼ç¼©æ”¾

- **æ™ºèƒ½ç¼©æ”¾**ï¼šæ ¹æ®ç›¸æœºé«˜åº¦è‡ªåŠ¨è°ƒæ•´æ ‡è®°å¤§å°
- **æ·¡å…¥æ·¡å‡º**ï¼šåœ¨å¯è§†èŒƒå›´å†…å®ç°å¹³æ»‘çš„é€æ˜åº¦è¿‡æ¸¡
- **æ€§èƒ½ä¼˜åŒ–**ï¼šä½¿ç”¨èŠ‚æµæœºåˆ¶é¿å…é¢‘ç¹æ›´æ–°

### ğŸ”§ é…ç½®é€‰é¡¹

```typescript
interface HeightResponsiveConfig {
  enabled?: boolean; // æ˜¯å¦å¯ç”¨é«˜åº¦å“åº”å¼ç¼©æ”¾
  referenceHeight?: number; // å‚è€ƒé«˜åº¦ï¼ˆåœ†é”¥ä½“é«˜åº¦ + 3000mï¼‰
  minScale?: number; // æœ€å°ç¼©æ”¾æ¯”ä¾‹
  maxScale?: number; // æœ€å¤§ç¼©æ”¾æ¯”ä¾‹
  fadeRange?: number; // æ·¡å…¥æ·¡å‡ºèŒƒå›´ï¼ˆç±³ï¼‰
  updateInterval?: number; // æ›´æ–°é—´éš”ï¼ˆæ¯«ç§’ï¼‰
}
```

## ğŸš€ ä½¿ç”¨ç¤ºä¾‹

### åŸºç¡€ç”¨æ³•

```typescript
import { RippleMarker } from "cesium-kit";

const marker = RippleMarker(viewer, {
  lon: 116.4074,
  lat: 39.9042,
  pyramidHeight: 1000,
  label: {
    text: "åŒ—äº¬å¸‚",
    font: "18px sans-serif",
    fillColor: "#ffffff",
    backgroundColor: "rgba(0, 0, 0, 0.8)",
  },
  // å¯ç”¨é«˜åº¦å“åº”å¼åŠŸèƒ½
  heightResponsive: {
    enabled: true,
    referenceHeight: 4000, // 1000m åœ†é”¥ä½“ + 3000m
    minScale: 0.2,
    maxScale: 3.0,
    fadeRange: 2000,
    updateInterval: 100,
  },
  onClick: (data, position) => {
    console.log("ç‚¹å‡»äº†æ ‡è®°:", data);
  },
});
```

### é«˜çº§é…ç½®

```typescript
// å¤šä¸ªä¸åŒé«˜åº¦çš„æ ‡è®°
const markers = [
  { lat: 39.9042, height: 1000, name: "ä½æµ·æ‹”æ ‡è®°" },
  { lat: 40.0, height: 2000, name: "ä¸­æµ·æ‹”æ ‡è®°" },
  { lat: 40.1, height: 3000, name: "é«˜æµ·æ‹”æ ‡è®°" },
];

markers.forEach((config, index) => {
  const marker = RippleMarker(viewer, {
    lon: 116.4074,
    lat: config.lat,
    pyramidHeight: config.height,
    data: { name: config.name },
    heightResponsive: {
      enabled: true,
      referenceHeight: config.height + 3000,
      minScale: 0.1,
      maxScale: 2.5,
      fadeRange: 1500,
      updateInterval: 50, // æ›´é¢‘ç¹çš„æ›´æ–°
    },
    label: {
      text: config.name,
      font: "16px sans-serif",
      fillColor: "#ffffff",
      backgroundColor: `rgba(${index * 50}, 100, 200, 0.8)`,
      backgroundCornerRadius: 15,
      backgroundPadding: { x: 10, y: 5 },
    },
  });
});
```

## ğŸ¯ æ•ˆæœè¯´æ˜

### ğŸ“ ç¼©æ”¾é€»è¾‘

- **ç›¸æœºé«˜åº¦ < 3000m**ï¼šæ ‡ç­¾é€‚åº¦ç¼©æ”¾ï¼Œå®Œå…¨ä¸éšè—ï¼Œä¿æŒæœ€ä½³å¯è§æ€§
- **3000m â‰¤ ç›¸æœºé«˜åº¦ < å‚è€ƒé«˜åº¦**ï¼šæ ‡ç­¾é€‚åº¦æ”¾å¤§ï¼Œæœ€å¤§ä¸è¶…è¿‡ 150%ï¼Œä¿æŒè§†è§‰æ¯”ä¾‹
- **ç›¸æœºé«˜åº¦ â‰¥ å‚è€ƒé«˜åº¦**ï¼šæ ‡ç­¾ç¼©å°ï¼Œé¿å…é®æŒ¡
- **ç¼©æ”¾èŒƒå›´**ï¼šåœ¨ `minScale` å’Œ `maxScale` ä¹‹é—´åŠ¨æ€è°ƒæ•´
- **åœ†é”¥ä½“**ï¼šä¸å‚ä¸ç¼©æ”¾å˜å½¢ï¼Œä¿æŒåŸå§‹å°ºå¯¸ï¼Œåªå‚ä¸æ˜¾ç¤º/éšè—
- **æ¶Ÿæ¼ª**ï¼šä¸åœ†é”¥ä½“åŒæ­¥ï¼Œå‚ä¸æ˜¾ç¤º/éšè—æ•ˆæœ

### ğŸŒ… æ·¡å…¥æ·¡å‡ºé€»è¾‘

- **é«˜åº¦ < 3000m**ï¼šå®Œå…¨æ˜¾ç¤ºï¼ˆopacity = 1ï¼‰ï¼Œä¸éšè—
- **3000m â‰¤ é«˜åº¦ < å‚è€ƒé«˜åº¦**ï¼šå®Œå…¨æ˜¾ç¤ºï¼ˆopacity = 1ï¼‰
- **é«˜åº¦ â‰¥ å‚è€ƒé«˜åº¦**ï¼šæ ¹æ®è·ç¦»å‚è€ƒé«˜åº¦çš„å·®å€¼è®¡ç®—é€æ˜åº¦
- **æ·¡å‡ºèŒƒå›´**ï¼šåœ¨ `fadeRange` è·ç¦»å†…å®ç°å¹³æ»‘è¿‡æ¸¡
- **åœ†é”¥ä½“å’Œæ¶Ÿæ¼ªå¯è§æ€§**ï¼šå½“é€æ˜åº¦ä½äº 0.1 æ—¶å®Œå…¨éšè—

### âš¡ æ€§èƒ½ä¼˜åŒ–

- **èŠ‚æµæ›´æ–°**ï¼šé¿å…æ¯å¸§éƒ½æ›´æ–°ï¼Œä½¿ç”¨ `updateInterval` æ§åˆ¶é¢‘ç‡
- **é«˜åº¦å·®æ£€æµ‹**ï¼šåªæœ‰é«˜åº¦å˜åŒ–è¶…è¿‡ 10m æ‰æ›´æ–°
- **é”™è¯¯å¤„ç†**ï¼šåŒ…å«å®Œæ•´çš„ try-catch é”™è¯¯å¤„ç†
- **åœºæ™¯å…¼å®¹æ€§**ï¼šæ£€æµ‹ viewer å’Œ scene çŠ¶æ€ï¼Œè‡ªåŠ¨é”€æ¯æ— æ•ˆç»„ä»¶
- **è‡ªåŠ¨æ¸…ç†**ï¼šå½“æ£€æµ‹åˆ°åœºæ™¯é”™è¯¯æ—¶ï¼Œè‡ªåŠ¨é”€æ¯ç»„ä»¶é¿å…å†…å­˜æ³„æ¼

## ğŸ”§ API æ–¹æ³•

### æ‰‹åŠ¨æ›´æ–°

```typescript
// æ‰‹åŠ¨è§¦å‘é«˜åº¦å“åº”å¼æ›´æ–°
marker.updateHeightResponsive();
```

### æ˜¾ç¤º/éšè—æ§åˆ¶

```typescript
marker.show(); // æ˜¾ç¤ºæ ‡è®°
marker.hide(); // éšè—æ ‡è®°
marker.setVisible(true); // è®¾ç½®å¯è§æ€§
marker.remove(); // ç§»é™¤æ ‡è®°
```

## ğŸ¨ è§†è§‰æ•ˆæœ

### é«˜åº¦å˜åŒ–æ—¶çš„æ•ˆæœ

1. **ä½ç©ºé£è¡Œ**ï¼šæ ‡è®°æ”¾å¤§ï¼Œç»†èŠ‚æ¸…æ™°å¯è§
2. **ä¸­ç©ºé£è¡Œ**ï¼šæ ‡è®°é€‚ä¸­ï¼Œå¹³è¡¡è§†è§‰æ•ˆæœ
3. **é«˜ç©ºé£è¡Œ**ï¼šæ ‡è®°ç¼©å°ï¼Œé¿å…è§†è§‰æ··ä¹±
4. **æé«˜ç©º**ï¼šæ ‡è®°æ·¡å‡ºï¼Œä¿æŒåœºæ™¯æ•´æ´

### å¹³æ»‘è¿‡æ¸¡

- æ‰€æœ‰ç¼©æ”¾å’Œé€æ˜åº¦å˜åŒ–éƒ½æ˜¯å¹³æ»‘çš„
- é¿å…çªå…€çš„è§†è§‰è·³è·ƒ
- ä¿æŒç”¨æˆ·ä½“éªŒçš„è¿è´¯æ€§

## ğŸš€ æœ€ä½³å®è·µ

### é…ç½®å»ºè®®

```typescript
// æ¨èé…ç½®
heightResponsive: {
    enabled: true,
    referenceHeight: pyramidHeight + 3000, // åŠ¨æ€è®¡ç®—
    minScale: 0.3,    // æœ€å° 30% å¤§å°
    maxScale: 1.5,    // æœ€å¤§ 150% å¤§å°ï¼Œé¿å…è¿‡åº¦æ”¾å¤§
    fadeRange: 3000,  // 3km æ·¡å…¥æ·¡å‡ºèŒƒå›´
    updateInterval: 100, // 100ms æ›´æ–°é—´éš”
}
```

### æ€§èƒ½è€ƒè™‘

- å¯¹äºå¤§é‡æ ‡è®°ï¼Œå»ºè®®é€‚å½“å¢åŠ  `updateInterval`
- æ ¹æ®åœºæ™¯å¤æ‚åº¦è°ƒæ•´ `fadeRange`
- åœ¨é«˜æ€§èƒ½è¦æ±‚çš„åœºæ™¯ä¸­å¯ä»¥ç¦ç”¨æ­¤åŠŸèƒ½

## ğŸ‰ æ€»ç»“

é«˜åº¦å“åº”å¼ç¼©æ”¾åŠŸèƒ½è®© `RippleMarker` åœ¨ä¸åŒç›¸æœºé«˜åº¦ä¸‹éƒ½èƒ½æä¾›æœ€ä½³çš„è§†è§‰ä½“éªŒï¼Œæ—¢ä¿æŒäº†æ ‡è®°çš„å¯è¯»æ€§ï¼Œåˆé¿å…äº†è§†è§‰å¹²æ‰°ã€‚é€šè¿‡æ™ºèƒ½çš„ç¼©æ”¾å’Œæ·¡å…¥æ·¡å‡ºæœºåˆ¶ï¼Œè®© 3D åœºæ™¯æ›´åŠ è‡ªç„¶å’Œç¾è§‚ã€‚
